<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Simple Resume Generator</title>
  <!-- Tailwind CDN -->
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 min-h-screen flex items-center justify-center p-4">
<div class="w-full max-w-xl bg-white rounded-2xl shadow-lg p-8">
  <h1 class="text-3xl font-bold text-center mb-6">Resume Generator</h1>
  <form id="resumeForm" class="space-y-4">
    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <label class="block">
        <span class="text-gray-700">Name</span>
        <input name="name" required
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
      <label class="block">
        <span class="text-gray-700">Phone</span>
        <input name="phone" required
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
    </div>

    <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
      <label class="block">
        <span class="text-gray-700">Email</span>
        <input type="email" name="email" required
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
      <label class="block">
        <span class="text-gray-700">City</span>
        <input name="city" required
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
    </div>

    <label class="block">
      <span class="text-gray-700">Target Job</span>
      <input name="targetJob" required
             class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
    </label>

    <fieldset class="border border-gray-200 rounded-lg p-4">
      <legend class="text-gray-700 font-semibold">School Info</legend>
      <div class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-2">
        <label class="block">
          <span class="text-gray-700">School Name</span>
          <input name="school.name" required
                 class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
        </label>
        <label class="block">
          <span class="text-gray-700">Degree</span>
          <input name="school.degree" required
                 class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
        </label>
        <label class="block sm:col-span-2">
          <span class="text-gray-700">Graduation (e.g. May 2025)</span>
          <input name="school.graduation" required
                 class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
        </label>
      </div>
    </fieldset>

    <div class="grid grid-cols-1 sm:grid-cols-3 gap-4">
      <label class="block">
        <span class="text-gray-700">Computer Skills</span>
        <input name="computerSkills"
               placeholder="Word, Excel"
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
      <label class="block">
        <span class="text-gray-700">Languages</span>
        <input name="languages"
               placeholder="English, Tamil"
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
      <label class="block">
        <span class="text-gray-700">Other Skills</span>
        <input name="otherSkills"
               placeholder="Customer service, Teamwork"
               class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
      </label>
    </div>

    <label class="block">
      <span class="text-gray-700">Projects (JSON array)</span>
      <textarea name="projects" rows="3"
                placeholder='[{"title":"X","description":"Y"}]'
                class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"></textarea>
    </label>

    <label class="block">
      <span class="text-gray-700">Hobbies (comma-separated)</span>
      <input name="hobbies"
             placeholder="Football, Volunteering"
             class="mt-1 block w-full border border-gray-300 rounded-lg p-2 focus:ring-blue-500 focus:border-blue-500"/>
    </label>

    <button type="submit"
            class="w-full bg-blue-600 text-white font-semibold py-2 rounded-lg hover:bg-blue-700 transition">
      Generate Word
    </button>
  </form>
</div>

<script>
  document.getElementById('resumeForm').addEventListener('submit', async e => {
    e.preventDefault();
    const form = e.target;

    const payload = {
      name: form.name.value,
      phone: form.phone.value,
      email: form.email.value,
      city: form.city.value,
      targetJob: form.targetJob.value,
      school: {
        name: form['school.name'].value,
        degree: form['school.degree'].value,
        graduation: form['school.graduation'].value
      },
      computerSkills: form.computerSkills.value.split(',').map(s=>s.trim()).filter(s=>s),
      languages: form.languages.value.split(',').map(s=>s.trim()).filter(s=>s),
      otherSkills: form.otherSkills.value.split(',').map(s=>s.trim()).filter(s=>s),
      projects: (() => {
        try { return JSON.parse(form.projects.value || '[]'); }
        catch { return []; }
      })(),
      hobbies: form.hobbies.value.split(',').map(s=>s.trim()).filter(s=>s)
    };

    const resp = await fetch('/api/resume/docx', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(payload)
    });

    if (!resp.ok) {
      return alert('Error generating resume');
    }

    const blob = await resp.blob();
    const url  = URL.createObjectURL(blob);
    const a    = document.createElement('a');
    a.href     = url;
    a.download = 'resume.docx';
    a.click();
    URL.revokeObjectURL(url);
  });
</script>
</body>
</html>
